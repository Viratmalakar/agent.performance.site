<!DOCTYPE html>
<html>
<head>
<title>Dashboard</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
body{font-family:Segoe UI;background:#f4fff6;margin:0}
header{background:#1fa463;color:white;padding:15px;font-size:22px;text-align:center}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px;padding:20px}
.card{background:white;padding:15px;border-left:6px solid #1fa463;box-shadow:0 2px 6px #ccc;transition:.3s}
.card:hover{transform:scale(1.05)}
.box{padding:20px}
table{width:100%;border-collapse:collapse;background:white}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#1fa463;color:white}
tbody tr:hover{background:#eafff1}
.search{width:250px;padding:8px;margin-bottom:10px}
.scroll{max-height:520px;overflow:auto}
button{background:#1fa463;color:white;border:none;padding:10px 18px;border-radius:6px;margin:5px}
</style>
</head>
<body>

<header>Agent Performance Dashboard</header>

<div class="cards">
<div class="card"><b>TOTAL IVR HIT</b><h3>{{gt["TOTAL IVR HIT"]}}</h3></div>
<div class="card"><b>TOTAL MATURE</b><h3>{{gt["TOTAL MATURE"]}}</h3></div>
<div class="card"><b>IB MATURE</b><h3>{{gt["IB MATURE"]}}</h3></div>
<div class="card"><b>OB MATURE</b><h3>{{gt["OB MATURE"]}}</h3></div>
<div class="card"><b>TOTAL TALK TIME</b><h3>{{gt["TOTAL TALK TIME"]}}</h3></div>
<div class="card"><b>AHT</b><h3>{{gt["AHT"]}}</h3></div>
<div class="card"><b>LOGIN COUNT</b><h3>{{gt["LOGIN COUNT"]}}</h3></div>
</div>

<div class="box">
<input class="search" id="search" placeholder="Search Agent Name...">
<button onclick="copyImage()">Copy Table Image</button>

<div class="scroll" id="tableArea">
<table>
<thead>
<tr>{% for k in data[0].keys() %}<th>{{k}}</th>{% endfor %}</tr>
</thead>
<tbody>
{% for r in data %}
<tr>{% for v in r.values() %}<td>{{v}}</td>{% endfor %}</tr>
{% endfor %}
</tbody>
</table>
</div>
</div>

<div style="text-align:center">
<button onclick="location.href='/export'">Export Excel</button>
<button onclick="location.href='/'">Reset</button>
</div>

<footer style="text-align:center;padding:10px">Website created by Chandan Malakar</footer>

<script>
document.getElementById("search").addEventListener("keyup",function(){
 let v=this.value.toLowerCase();
 document.querySelectorAll("tbody tr").forEach(r=>{
   r.style.display=r.innerText.toLowerCase().includes(v)?"":"none";
 });
});

function copyImage(){
 html2canvas(document.getElementById("tableArea")).then(c=>{
   c.toBlob(b=>{
     navigator.clipboard.write([new ClipboardItem({"image/png":b})]);
     alert("Table copied as image");
   });
 });
}
</script>

</body>
</html>
