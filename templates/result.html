<!DOCTYPE html>
<html>
<head>
<title>Agent Performance Dashboard</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{
    font-family:Segoe UI,Arial;
    background:linear-gradient(135deg,#eafff1,#f6fff9);
    margin:0;
}
header{
    background:linear-gradient(90deg,#1f7f52,#1fa463);
    color:white;
    padding:15px;
    font-size:22px;
    text-align:center;
    font-weight:bold;
}

.cards{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
    gap:15px;
    padding:20px;
}

.card{
    background:rgba(255,255,255,0.85);
    backdrop-filter:blur(6px);
    border-radius:12px;
    padding:15px;
    box-shadow:0 4px 10px rgba(0,0,0,.1);
    border-left:6px solid #1fa463;
}

.card b{color:#555;font-size:13px}
.card h3{margin:6px 0;color:#1fa463;font-size:22px}

.box{
    padding:20px;
}

.table-box{
    background:rgba(255,255,255,0.9);
    backdrop-filter:blur(5px);
    border-radius:12px;
    box-shadow:0 4px 10px rgba(0,0,0,.1);
    overflow:auto;
    max-height:620px;
}

table{
    width:100%;
    border-collapse:collapse;
}

th,td{
    border:1px solid #dcdcdc;
    padding:8px;
    text-align:center;
    font-size:14px;
}

th{
    background:#2f7f63;
    color:white;
    position:sticky;
    top:0;
    z-index:2;
}

tr:nth-child(even){background:#f4fff8}

.btns{
    text-align:center;
    margin:20px;
}

button{
    background:linear-gradient(90deg,#1f7f52,#1fa463);
    color:white;
    border:none;
    padding:10px 20px;
    border-radius:8px;
    margin:6px;
    font-size:15px;
    cursor:pointer;
    box-shadow:0 3px 6px rgba(0,0,0,.15);
}

button:hover{opacity:.9}

footer{
    text-align:center;
    padding:12px;
    color:#444;
}
</style>
</head>

<body>

<header>Agent Performance Dashboard</header>

<div class="cards">

<div class="card"><b>TOTAL IVR HIT</b><h3>{{gt["TOTAL IVR HIT"]}}</h3></div>
<div class="card"><b>TOTAL MATURE</b><h3>{{gt["TOTAL MATURE"]}}</h3></div>
<div class="card"><b>IB MATURE</b><h3>{{gt["IB MATURE"]}}</h3></div>
<div class="card"><b>OB MATURE</b><h3>{{gt["OB MATURE"]}}</h3></div>
<div class="card"><b>TOTAL TALK TIME</b><h3>{{gt["TOTAL TALK TIME"]}}</h3></div>
<div class="card"><b>AHT (AVG)</b><h3>{{gt["AHT"]}}</h3></div>
<div class="card"><b>LOGIN COUNT</b><h3>{{gt["LOGIN COUNT"]}}</h3></div>

</div>

<div class="box">
<div class="table-box" id="tableBox">
<table>

<tr>
<th>Agent Name</th>
<th>Agent Full Name</th>
<th>Total Login Time</th>
<th>Total Net Login</th>
<th>Total Break</th>
<th>Total Meeting</th>
<th>AHT</th>
<th>Total Call</th>
<th>IB Mature</th>
<th>OB Mature</th>
</tr>

{% for r in data %}
<tr>
<td>{{r["Agent Name"]}}</td>
<td>{{r["Agent Full Name"]}}</td>
<td>{{r["Total Login Time"]}}</td>
<td>{{r["Total Net Login"]}}</td>
<td>{{r["Total Break"]}}</td>
<td>{{r["Total Meeting"]}}</td>
<td>{{r["AHT"]}}</td>
<td>{{r["Total Call"]}}</td>
<td>{{r["IB Mature"]}}</td>
<td>{{r["OB Mature"]}}</td>
</tr>
{% endfor %}

</table>
</div>
</div>

<div class="btns">
<button onclick="copyTable()">Copy Table</button>
<button onclick="location.href='/export'">Export Excel</button>
<button onclick="location.href='/'">Reset</button>
</div>

<footer>Website created by Chandan Malakar</footer>

<script>
function copyTable(){
    html2canvas(document.getElementById("tableBox")).then(canvas=>{
        canvas.toBlob(blob=>{
            navigator.clipboard.write([new ClipboardItem({"image/png":blob})]);
            alert("Table copied as image!");
        })
    })
}
</script>

</body>
</html>
